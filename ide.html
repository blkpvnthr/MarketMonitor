<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AlgoBot ‚Ä¢ IDE Documentation</title>

  <link rel="stylesheet" href="/includes/CSS/styles.css"/>
  <link rel="icon" type="image/x-icon" href="../static/favicon.ico" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

  <style>
    :root{
      --bg:#ffffff;
      --panel: rgba(0,0,0,.03);
      --panel2: rgba(0,0,0,.05);
      --text:#0b0f17;
      --muted: rgba(11,15,23,.62);
      --line: rgba(0,0,0,.12);
      --accent:#2563eb;
      --good:#16a34a;
      --warn:#d97706;
      --bad:#dc2626;
      --shadow:0 14px 40px rgba(0,0,0,.10);
      --radius:16px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:'Roboto', ui-sans-serif, system-ui, -apple-system, Segoe UI, Helvetica, Arial;
      color:var(--text);
      background:var(--bg);
      min-height:100vh;
    }

    /* ===== Glass Navbar ===== */
    .navbar{
      position:sticky; top:0; z-index:50;
      border-bottom:1px solid var(--line);
      background:rgba(255,255,255,.85);
      backdrop-filter:blur(10px);
    }
    .navbar .navwrap{
      margin:0 auto;
      padding:12px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
    }
    .navwrap{ max-width:1600px; }
    .navLinks{ display:flex; align-items:center; gap:16px; }
    .navLinks a{ padding:6px 10px; border-radius:10px; }
    a{ color:#0b0f17 !important; text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .wrap{ max-width:1200px; margin:0 auto; padding:22px 18px 42px; }
    /* --- NAVBAR: bulletproof 3-column layout --- */
    .navwrap{
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 10px 16px;
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      column-gap: 18px;
    }
    .navLinks a.active{ text-decoration: underline; }

    /* Left */
    .navLeft{ min-width: 0; }
    .navTitle{
      display: inline-flex;
      align-items: baseline;
      gap: 8px;
      white-space: nowrap;
    }

    /* Center */
    .navLinks{
      display: flex;
      justify-content: center;
      gap: 18px;
      min-width: 0;
    }
    .navLinks a{ white-space: nowrap; }

    /* Right */
    .navRight{
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 12px;
      min-width: 0;
      margin-left:auto;
    }
    .navSearch{ width: min(420px, 34vw); min-width: 260px; }

    /* ===== Header ===== */
    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      margin:6px 0 14px;
    }
    .brand{ display:flex; flex-direction:column; gap:6px; }
    .brand h1{
      margin:0;
      font-size:26px;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .logo{
      width:36px; height:36px;
      border-radius:12px;
      background:linear-gradient(135deg, rgba(37,99,235,.95), rgba(99,102,241,.9));
      box-shadow:0 10px 22px rgba(37,99,235,.18);
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      color:#fff;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
      max-width:740px;
    }

    .status{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.9);
      box-shadow:var(--shadow);
      white-space:nowrap;
      user-select:none;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background:var(--warn);
      box-shadow:0 0 0 4px rgba(217,119,6,.18);
    }
    .status strong{ font-size:13px; }
    .status span{ color:var(--muted); font-size:12px; }

    /* ===== Cards / Layout ===== */
    .docGrid{
      display:grid;
      grid-template-columns:320px 1fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width:980px){ .docGrid{ grid-template-columns:1fr; } }

    .card{
      background:rgba(255,255,255,.95);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(0,0,0,.03), transparent);
      gap:10px;
    }
    .card .hd h2{
      margin:0;
      font-size:14px;
      letter-spacing:.3px;
      color:rgba(11,15,23,.92);
      display:flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .pill{
      font-size:12px;
      color:rgba(11,15,23,.72);
      border:1px solid var(--line);
      padding:6px 10px;
      border-radius:999px;
      background:rgba(0,0,0,.03);
    }
    .card .bd{ padding:16px; }

    /* ===== Doc page extras ===== */
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid transparent;
      color:rgba(11,15,23,.85) !important;
    }
    .toc a:hover{ background:var(--panel); text-decoration:none; }
    .toc a.active{
      border-color:rgba(37,99,235,.22);
      background:rgba(37,99,235,.08);
      font-weight:700;
    }

    .prose h3{ margin: 18px 0 8px; font-size: 15px; letter-spacing:.2px; }
    .prose p{ margin: 0 0 10px; color: rgba(11,15,23,.86); line-height: 1.6; font-size: 13.5px; }
    .prose ul{ margin: 0 0 12px 18px; color: rgba(11,15,23,.86); line-height: 1.6; font-size: 13.5px; }
    .prose li{ margin: 6px 0; }
    .kbd, .code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New";
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,.12);
      background: rgba(0,0,0,.03);
      white-space: nowrap;
    }
    pre{
      margin: 10px 0 12px;
      padding: 12px;
      border: 1px solid rgba(0,0,0,.12);
      background: rgba(0,0,0,.02);
      border-radius: 14px;
      overflow:auto;
      max-height: 360px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New";
      font-size: 12px;
      line-height: 1.45;
    }
    .note{
      border:1px solid rgba(0,0,0,.12);
      background:rgba(0,0,0,.02);
      border-radius:14px;
      padding:12px;
      font-size:13px;
      color:rgba(11,15,23,.85);
    }
    .note strong{ display:block; margin-bottom:6px; }

    /* User Menu */
    .userMenu { position: relative; margin-left: 10px; }
    .userBtn {
      display: flex;
      align-items: center;
      gap: 6px;
      background: transparent;
      border: 1px solid var(--line);
      border-radius: 999px;
      padding: 4px 8px;
      cursor: pointer;
      color: var(--text);
    }
    .userBtn:hover { background: var(--panel); }
    .avatar {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--accent);
      color: #fff;
      display: grid;
      place-items: center;
      font-size: 12px;
      font-weight: 600;
    }
    .caret { font-size: 10px; opacity: 0.7; }

    /* Dropdown */
    .userDropdown {
      position: absolute;
      right: 0;
      top: calc(100% + 8px);
      min-width: 190px;
      background: #fff;
      border: 1px solid var(--line);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 6px 0;
      display: none;
      z-index: 1000;
    }
    .userDropdown a {
      display: block;
      padding: 8px 14px;
      text-decoration: none;
      color: var(--text);
      font-size: 14px;
    }
    .userDropdown a:hover { background: var(--panel); }
    .userDropdown .divider { height: 1px; background: var(--line); margin: 6px 0; }
    .userDropdown .danger { color: var(--bad); }

    .footbar{
      display:flex;
      justify-content:space-between;
      padding:10px 14px 12px;
      color:rgba(11,15,23,.62);
      font-size:12px;
      gap:12px;
      flex-wrap:wrap;
    }
  </style>
</head>


<body>
  <!-- Navbar -->
  <nav class="navbar" role="navigation" aria-label="Primary">
    <div class="navwrap">
      <div class="navLeft">
        <a href="/" style="text-decoration:none;color:inherit;">
          <div class="navTitle">
            <strong>Quantum<span style="font-weight: 100 !important;">Quant</span></strong>
          </div>
        </a>
      </div>

      <div class="navLinks" aria-label="Quick links">
        <a href="/index.html">Dashboard</a>
        <a href="/brokers.html">Brokers</a>
        <a href="/ide.html" class="active">IDE Documentation</a>
        <a href="/script.html">Strategy</a>
        <a href="/backtests.html">Backtests</a>
      </div>

      <div class="navRight">
        <input class="navSearch" id="nav-search" type="text" placeholder="Search this page (e.g. backtest, run live)" />
        <span class="pill" id="nav-clock">--:--</span>

        <div class="userMenu" id="userMenu">
          <button class="userBtn" id="userBtn" aria-haspopup="true" aria-expanded="false" type="button">
            <span class="avatar" id="userAvatar">AQ</span>
            <span class="caret">‚ñæ</span>
          </button>

          <div class="userDropdown" id="userDropdown" role="menu" aria-label="User menu">
            <a href="/account.html">Account</a>
            <a href="/settings.html">Settings</a>
            <a href="/trades.html">Trade Logs</a>
            <a href="/security.html">Security</a>
            <a href="/ideas.html">Ideas</a>
            <div class="divider"></div>
            <a href="/help.html">Help</a>
            <div class="divider"></div>
            <a href="/login.html" id="loginLink">Log in</a>
            <a href="/logout" id="logoutLink" class="danger" style="display:none;">Log out</a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <div class="wrap">
    <header>
      <div class="brand">
        <h1><span class="logo">Q</span> Script IDE: Quick User Guide</h1>
        <p class="subtitle">
          Click-by-click instructions + copy/paste starter code. Use <span class="code">Run Paper</span> first.
        </p>
      </div>

      <div class="status">
        <span class="dot"></span>
        <div style="display:flex;flex-direction:column;line-height:1.1">
          <strong>Tip</strong>
          <span style="font-size:12px;color:var(--muted)">Start with Quick Start</span>
        </div>
      </div>
    </header>

    <div class="docGrid">
      <!-- TOC -->
      <aside class="card">
        <div class="hd">
          <div style="display:flex;align-items:center;gap:10px">
            <strong>üìö Sections</strong>
            <span class="pill" id="tocCount">0</span>
          </div>
          <span class="pill">Guide</span>
        </div>
        <div class="bd">
          <div class="toc" id="toc"></div>
          <div class="note" style="margin-top:12px">
            <strong>Search</strong>
            Use the top search box to filter sections by keyword.
          </div>
        </div>
      </aside>

      <!-- CONTENT -->
      <main class="card">
        <div class="hd">
          <strong>üß† How to use it</strong>
          <span class="pill">Beginner</span>
        </div>

        <div class="bd prose" id="docRoot">
          <section id="quickstart" data-title="Quick Start">
            <h3>Quick Start</h3>
            <ul>
              <li><strong>1)</strong> Open <span class="code">Strategy</span> (the IDE page).</li>
              <li><strong>2)</strong> Click a script file (or create one).</li>
              <li><strong>3)</strong> Paste starter code (below) into the editor.</li>
              <li><strong>4)</strong> Click <strong>Save</strong>.</li>
              <li><strong>5)</strong> Click <strong>Run Paper</strong> (safe test mode).</li>
              <li><strong>6)</strong> If it looks good, run a <strong>Backtest</strong>.</li>
            </ul>
          </section>

          <section id="starter-code" data-title="Starter Code (copy/paste)">
            <h3>Starter Code (copy/paste)</h3>
            <p>Minimal ‚Äúsignal‚Äù strategy that prints what it would do. Safe for Paper mode.</p>
<pre># starter_strategy.py
# This is a simple template. Your backend decides how orders/logging work.

def on_tick(price, sma_fast, sma_slow):
    """
    Called when a new price arrives.
    If fast SMA > slow SMA -> BUY idea
    If fast SMA < slow SMA -> SELL idea
    """
    if sma_fast > sma_slow:
        print(f"BUY signal | price={price} fast={sma_fast} slow={sma_slow}")
        return "BUY"
    elif sma_fast < sma_slow:
        print(f"SELL signal | price={price} fast={sma_fast} slow={sma_slow}")
        return "SELL"
    else:
        print(f"HOLD | price={price} fast={sma_fast} slow={sma_slow}")
        return "HOLD"</pre>

            <div class="note">
              <strong>What to change first</strong>
              Change the numbers you use for <span class="code">sma_fast</span> and <span class="code">sma_slow</span> (in Backtest params).
            </div>
          </section>

          <section id="save-open" data-title="Open + Save scripts">
            <h3>Open + Save scripts</h3>
            <ul>
              <li><strong>Open:</strong> click a script name in the scripts list/explorer ‚Üí code loads into the editor.</li>
              <li><strong>Save:</strong> click <strong>Save</strong> ‚Üí current editor text is stored on the server.</li>
            </ul>
          </section>

          <section id="run-paper-live" data-title="Run Paper vs Run Live">
            <h3>Run Paper vs Run Live</h3>
            <ul>
              <li><strong>Run Paper:</strong> practice trades / no real money (recommended).</li>
              <li><strong>Run Live:</strong> real trades (only after testing).</li>
              <li><strong>Stop:</strong> ends the current run.</li>
            </ul>
            <div class="note">
              <strong>Dot colors</strong>
              Orange = starting/idle, Green = running/OK, Red = error.
            </div>
          </section>

          <section id="backtest" data-title="Backtest (test on old data)">
            <h3>Backtest (test on old data)</h3>
            <p>Backtest uses whatever is in the editor.</p>
            <ul>
              <li>Pick <strong>Symbol</strong>, <strong>Timeframe</strong>, <strong>Start</strong>, <strong>End</strong>.</li>
              <li>Optional: edit <strong>Params (JSON)</strong> (example below).</li>
              <li>Click <strong>Run Backtest</strong>.</li>
            </ul>

<pre>{
  "fast": 20,
  "slow": 50
}</pre>
          </section>

          <section id="common-errors" data-title="Common problems">
            <h3>Common problems</h3>
            <ul>
              <li><strong>Backtest says editor is empty:</strong> paste code ‚Üí Save ‚Üí try again.</li>
              <li><strong>Run turns red (error):</strong> check logs; fix the line it complains about; Save; Run Paper again.</li>
              <li><strong>Nothing happens on Run:</strong> backend endpoint might be down (<span class="code">/api/run</span>).</li>
              <li><strong>No logs showing:</strong> your server needs to stream logs over WebSocket.</li>
            </ul>
          </section>

          <section id="api-quick-map" data-title="How the page talks to the server">
            <h3>How the page talks to the server</h3>
            <p>You don‚Äôt need this to use the IDE, but it helps debugging.</p>
<pre>GET  /api/scripts          -> list scripts
GET  /api/scripts/{id}     -> load one script
POST /api/scripts          -> save/create script (name + code)
POST /api/run              -> start paper/live run
POST /api/stop/{run_id}    -> stop run
POST /api/backtest         -> run backtest with strategy_code</pre>
          </section>
        </div>

        <div class="footbar">
          <span>Tip: Start in <strong>Paper</strong>, then Backtest, then Live.</span>
          <span class="pill">AlgoBot IDE</span>
        </div>
      </main>
    </div>
  </div>

  <script>
    // ===== TOC builder =====
    (function buildTOC(){
      const toc = document.getElementById("toc");
      const sections = Array.from(document.querySelectorAll("#docRoot section[data-title]"));
      const count = document.getElementById("tocCount");
      if (count) count.textContent = String(sections.length);

      sections.forEach(sec => {
        const a = document.createElement("a");
        a.href = `#${sec.id}`;
        a.textContent = sec.getAttribute("data-title");
        toc.appendChild(a);
      });
    })();

    // ===== navbar clock =====
    (function clock(){
      const el = document.getElementById("nav-clock");
      function tick(){
        const d = new Date();
        const t = d.toLocaleTimeString([], { hour: "2-digit", minute:"2-digit" });
        if (el) el.textContent = t;
      }
      tick(); setInterval(tick, 1000 * 10);
    })();

    // ===== page search (filters sections) =====
    (function pageSearch(){
      const q = document.getElementById("nav-search");
      const sections = Array.from(document.querySelectorAll("#docRoot section"));
      const tocLinks = Array.from(document.querySelectorAll("#toc a"));
      if (!q) return;

      function apply(){
        const term = (q.value || "").trim().toLowerCase();
        sections.forEach(sec => {
          const text = sec.innerText.toLowerCase();
          const ok = !term || text.includes(term);
          sec.style.display = ok ? "" : "none";
        });

        // hide toc links for hidden sections
        tocLinks.forEach(a => {
          const id = a.getAttribute("href").slice(1);
          const sec = document.getElementById(id);
          a.style.display = (sec && sec.style.display === "none") ? "none" : "block";
        });
      }
      q.addEventListener("input", apply);
    })();

    // ===== user dropdown =====
    (function dropdown(){
      const userBtn = document.getElementById("userBtn");
      const dd = document.getElementById("userDropdown");
      if (!userBtn || !dd) return;

      userBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        const open = dd.style.display === "block";
        dd.style.display = open ? "none" : "block";
        userBtn.setAttribute("aria-expanded", String(!open));
      });

      document.addEventListener("click", () => {
        dd.style.display = "none";
        userBtn.setAttribute("aria-expanded", "false");
      });
    })();

    // ===== login state (same pattern as your app) =====
    (function authState(){
      const token =
        localStorage.getItem("auth_token") ||
        sessionStorage.getItem("auth_token");

      const userRaw =
        localStorage.getItem("auth_user") ||
        sessionStorage.getItem("auth_user");

      const loginLink  = document.getElementById("loginLink");
      const logoutLink = document.getElementById("logoutLink");
      const avatar     = document.getElementById("userAvatar");

      function clearAuth(){
        localStorage.removeItem("auth_token");
        localStorage.removeItem("auth_user");
        sessionStorage.removeItem("auth_token");
        sessionStorage.removeItem("auth_user");
      }

      if (token && userRaw) {
        try {
          const user = JSON.parse(userRaw);
          if (avatar && user.initials) avatar.textContent = user.initials.toUpperCase();
          if (loginLink)  loginLink.style.display = "none";
          if (logoutLink) logoutLink.style.display = "block";
        } catch {
          clearAuth();
        }
      } else {
        if (avatar) avatar.textContent = "--";
        if (loginLink)  loginLink.style.display = "block";
        if (logoutLink) logoutLink.style.display = "none";
      }

      logoutLink?.addEventListener("click", (e) => {
        e.preventDefault();
        clearAuth();
        window.location.href = "/login.html";
      });
    })();
  </script>
</body>
</html>